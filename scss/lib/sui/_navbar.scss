
@import 'sui-variables';
@import 'sui-mixins';


///////////////////////////////////////////////////////////////////////////////////////
// Utilities (move somewhere else, but only used here for now until we finalize names
///////////////////////////////////////////////////////////////////////////////////////
$swooshLogoWidth: 18px;
$swooshLogoHeight: 21px;


.swoosh-logo {
  height: $swooshLogoHeight;
  width: $swooshLogoWidth;

  background-image: sui-image('masthead/orange-swoosh.png');
  background-size: cover;
}


/////////////////////////////////////////////////////////////////
// General (Global & Domestic) Nav styles
/////////////////////////////////////////////////////////////////

.nav-fluid-container {
  // Just like sui-fluid-container but for the navs
  // Mostly named differently b/c sui-fluid-container styles get tromped by some apps/pages
  @extend %extendable-fluid-container;
  padding: 0 $bodySidePadding;
  box-sizing: border-box;
}

body.narrow {
  .nav-fluid-container {
    min-width:$contentNarrowMinWidth;
  }
}

.community { /* still fixed for 6.0 release */
  .nav-fluid-container {
    width:$contentFixedWidth; 
  }
  
  body.narrow .nav-fluid-container {
    width:$contentNarrowFixedWidth;
  }
} 

.mobile-nav,
.site-navigation,
.sui-opt-in .mobile-nav,
.sui-opt-in .site-navigation {
  z-index:$zindexNavBar;
  a,
  a:hover,
  a:focus,
  a:active {
    text-decoration: none;
  }
}

.global-nav,
.domestic-nav,
.sui-opt-in .global-nav,
.sui-opt-in .domestic-nav {
  min-width: $contentMinWidth + 15px;
  @include box-sizing(border-box);

  *, *:before, *:after {
    @include box-sizing(border-box);

    font-family: "Open Sans", Arial, sans-serif;
  }
  a { font-size: 13px; }

}


/////////////////////////////////////////////////////////////////
// Domestic Nav
/////////////////////////////////////////////////////////////////

$globalDropdownShadow: 0px 1px 5px rgba(0, 0, 0, 0.2);

.global-nav {
  height:$global-navbar-height;
  z-index: $zindexNavBar;

  background-color: $spiceworksBlack;

  &.affix { @include fixed-top(); }

  ul { margin: 0; } // annoying global rule on ".sui-opt-in ul"
}

.global-nav_print-logo {
  display: none;
}

.global-nav_brand {
    float:left; background-image: sui-image('masthead/masthead_logo_small2.png');
    background-repeat: no-repeat; background-position: 0 50%; background-size: 158px 14px;
    width: 160px; text-indent: -999px; white-space: nowrap; height:$global-navbar-height;
}

.global-nav_menus {
  float:right;
}

$globalNavDropdownZindex: 1020;

.global-nav_menu {
  display: inline-block;
  position:relative;
  vertical-align: top;

  height: $global-navbar-height;
  padding-left: $global-navbar-widget-spacing;
  padding-right: $global-navbar-widget-spacing;

  &:empty { display: none; }

  &.open {
    .global-nav_dropdown:before { @include menu-notch(6px, 6px, #f2f2f2); } // left-right placement set below
    .global-nav_dropdown { display:block; }
    > a { color: #f2f2f2 }
  }

  > a {
    display: inline-block;

    line-height: 16px;
    max-height:$global-navbar-height;
    padding: 11px 0 13px;

    color: #bfbfbf;

    &:hover {
      color: #cbcbcb;

      .navbar-icon {
        &.apps-menu-icon { background-position: 0 -32px; }
        &.search-icon { background-position: -16px -32px; }
        &.community-notifications-icon { background-position: -32px -32px; }
        &.community-message-count-icon { background-position: -64px -32px; }
        &.app-alerts-icon { background-position: -48px -32px; }
      }
    }
  }

  > a > i, > a > span { display:inline-block; vertical-align:middle; }

  .stat-bubble { @include stat-bubble(); }

  .global-nav_dropdown {
    display:none; 
    position: absolute;
    top: 100%;
    left: 0;
    z-index: $globalNavDropdownZindex;
    float: left;
    margin: 0;
    margin-left: 0!important;

    border:none;
    @include border-radius( $radius: 0 0 3px 3px );
    padding: 4px 2px;
    list-style: none;
    background-clip: padding-box;
    overflow:visible; // so the notches show up

    background-color: #f2f2f2;
    @include box-shadow($globalDropdownShadow);

    a { color: #444444; }
  }
}

.global-apps-menu {
  position: relative; // To allow for notch
  margin-right: $global-navbar-menu-spacing - $global-navbar-widget-spacing;

  padding-right: $global-navbar-menu-spacing;
  padding-left: 0;

  // Have to do the notch specially for the apps menu since it now has 'overflow: auto' to allow
  // scrolling when the list is too long.
  &.open:before { 
    @include menu-notch(6px, 6px, #f2f2f2);
    z-index: $globalNavDropdownZindex + 1; // Has to be higher b/c shadow from apps menu
    top: auto;
    bottom: 0;
    left: 2px;
  }

  &:after { @include navbar-divider; content: " "; position: absolute; top: 0; right:0; }

  .global-nav_dropdown {
    left: -66px;
    right: auto;

    overflow: auto;
    max-height: 710px; // Show a bit of the next icon so scrollability is obvious
    min-width: 205px;
    max-width: 300px;

    li {
      &:first-child:after { // Divider line under "Spiceworks"
        content:" "; display:block; width:95%; height:2px; margin:5px auto;
        background-color:#dedede; border-bottom:1px solid #fafafa;
      }

      a {
        display:block;

        padding: 8px 12px;
        line-height:18px;
        overflow: hidden;
        text-overflow: ellipsis;

        white-space: nowrap;
        font-size:14px;

        span { margin-left: 9px; vertical-align:middle; }
      }
    }
  }
}

.global-search-menu {
  &.open .global-nav_dropdown:before { left: auto; right: 11px; } // Notch placement

  .global-nav_dropdown { width:0; height:0; left: auto; right: 0; padding:0; border:none; }
}

.global-community-notifications-menu {

  &.open .global-nav_dropdown:before { left: 50%; margin-left:-10px; } // Notch placement

  .global-nav_dropdown {
    left: -125px; width:290px;

    .header-bar {
      padding:12px 13px; overflow:hidden; border-bottom:1px solid #dfdfdf;

      h5 { float:left; color: #9d9d9d; }
      a {
        float: right; font-weight:bold;
        &[count="0"] { font-weight:normal; }
      }
    }

    ul {
      margin:0; padding:0;

      li {
        @include navmenu-vertical-dividers; padding:7px 13px;

        > i { float:left; margin-top:2px; }

        p {
          margin:0 0 2px 26px; @include styled-font( $size: 12px, $lineHeight: 17px ); white-space:normal;
          overflow:hidden; text-overflow: ellipsis;

          a {
            color: #575757; font-weight:bold;
            &:hover { color: $linkColor; text-decoration:none; }
          }
        }

        .time { margin-left:26px; @include styled-font( $size: 11px ); color: #9d9d9d; }
      }
    }
  }
}

.global-nav_dropdown_footer {
  padding:7px; border-top:1px solid #fafafa;
  a { display:block; padding:9px; text-align:center; background-color: #e6e6e6; border-radius:3px; }
}


.global-user-menu {
  &:before { @include navbar-divider; content: " "; position: absolute; top: 0; left:-1px; }
  padding-left: $global-navbar-menu-spacing; margin-left: $global-navbar-menu-spacing - $global-navbar-widget-spacing;
  padding-right: 0;

  &.open .global-nav_dropdown:before { left: 50%; } // Notch placement

  > a {
    line-height: 22px; padding-top: 8px; padding-bottom: 8px; white-space: nowrap;
    img { width: 24px; height: 24px; border-radius:3px; display: inline-block; vertical-align: middle; margin-right:5px; }
    .usernav-link {
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      vertical-align: middle; margin-left: 5px; max-width: 200px;
    }
  }

  .global-nav_dropdown {
    white-space: nowrap; left:auto; right:0; padding:6px;
    a { display:block; padding: 4px 20px 3px 10px; }
    a:hover { background-color: #E2E2E2; border-radius: 3px; }

    a.user-menu-entry--divider { // TODO: stop using 'a' in all these styles
      height: 1px;
      margin: 2px -7px;
      padding: 0;
      overflow: hidden;
      border-bottom: 1px solid $sui-light-gray;
    }

  }
}


.global-nav_mobile-nav-toggle { display: none; }

.global-nav_menu.open > a,
.global-nav_menu.open > a:hover {
  color: #f2f2f2;

  .navbar-icon {
    &.apps-menu-icon { background-position: 0 -16px; }
    &.search-icon { background-position: -16px -16px; }
    &.community-notifications-icon { background-position: -32px -16px; }
    &.community-message-count-icon { background-position: -64px -16px; }
    &.app-alerts-icon { background-position: -48px -16px; }
  }
}

.navbar-icon {
  display:inline-block;

  width:16px;
  height:16px;

  background-image: sui-image('masthead/global_navbar_icons.png');
  background-repeat: no-repeat;

  &.apps-menu-icon { background-position: 0 0; margin-right:5px; }
  &.search-icon { background-position: -16px 0; }
  &.community-notifications-icon { background-position: -32px 0; }
  &.community-message-count-icon { background-position: -64px 0; }
  &.app-alerts-icon { background-position: -48px 0; }
  &.search-page-icon { background-position: -80px 0; }
}

.guest-user-navmenu {

  padding-left: 0; margin-left: $global-navbar-widget-spacing - $global-navbar-menu-spacing;

  a {
    span {
      vertical-align: middle;
      display: inline-block;
      padding: 3px 20px;
    }

    &.join-button span {
      @extend .sui-bttn;
      @extend .sui-bttn-orange;

      padding: 2px 20px;

      line-height: 16px;
    }
  }
}

.apps-menu-image-icon,
.platform-app-icon {
  display:inline-block;
  vertical-align:middle;

  width:32px;
  height:32px;

  border-radius: 3px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

.platform-app-icon {
  background-repeat: no-repeat;
  background-image: sui-image('masthead/app-icons-sm.png');
  background-position: -64px -64px; // Empty slot in the bottom-right corner. Need a catch-all apps image
  background-size: 96px 96px;

  &.start-icon { background-position: -32px 0; box-shadow: none; }
  &.inventory-icon { background-position: 0, -32px; }
  &.helpdesk-icon { background-position: 0 0; }
  &.monitoring-icon { background-position: -64px 0; }
  &.reviews-icon { background-position: -64px -32px; }
  &.marketview-icon { background-position: -32px -32px; }
  &.appcenter-icon { background-position: 0 -64px; }

  &.plugin-icon {
    background-position: 0 0;
    background: none;

    &, &.plugin-icon--gradient1 {
      @include gradient-directional($startColor: nth($sui-blurple-gradient, 1), $endColor: nth($sui-blurple-gradient, 2));
    }
    &.plugin-icon--gradient2 {
      @include gradient-directional($startColor: nth($sui-blurple-gradient, 2), $endColor: nth($sui-blurple-gradient, 1));
    }
    &.plugin-icon--gradient3 {
      @include gradient-directional($startColor: nth($sui-mint-gradient, 1), $endColor: nth($sui-mint-gradient, 2));
    }
    &.plugin-icon--gradient4 {
      @include gradient-directional($startColor: nth($sui-mint-gradient, 2), $endColor: nth($sui-mint-gradient, 1));
    }
    &.plugin-icon--gradient5 {
      @include gradient-directional($startColor: nth($sui-sunset-gradient, 1), $endColor: nth($sui-sunset-gradient, 2));
    }
    &.plugin-icon--gradient6 {
      @include gradient-directional($startColor: nth($sui-sunset-gradient, 2), $endColor: nth($sui-sunset-gradient, 1));
    }

    .platform-app-icon_inner-icon {
      width: 32px;
      height: 32px;

      background-size: 96px 96px;
      background-repeat: no-repeat;
      background-image: sui-image('masthead/app-icons-sm.png');
      background-position: -32px -64px;
    }
  }
}

@media only screen and (-webkit-min-device-pixel-ratio: 2), 
only screen and (min-device-pixel-ratio: 2) {
  .global-nav { 
    .brand {
      float:left; background-image: sui-image('masthead/masthead_logo.png');
    }
  }

  .navbar-icon {
    background-image: sui-image('masthead/global_navbar_icons_large.png');
    background-size: 96px 48px;
  }

  .platform-app-icon {
    background-image: sui-image('masthead/app-icons.png');
    background-size: 96px 96px;

    &.plugin-icon {
      background-size: 32px 32px;

      .platform-app-icon_inner-icon {
        background-image: sui-image('masthead/app-icons.png');
        background-size: 96px 96px;
      }
    }
  }
}


/////////////////////////////////////////////////////////////////
// Domestic Nav
/////////////////////////////////////////////////////////////////

$domesticNavBrandAnimationTime: .15s;
$domesticNavLogoMargin: 6px;

.domestic-nav {
  z-index: $zindexNavBar - 1;

  height: $domestic-navbar-height;
  border-bottom: 1px solid #e5e5e5;

  background-color: $domestic-navbar-bg-color;

  &.affix-top { position: absolute; left: 0; right: 0; top: $global-navbar-height; }

  &.affix {
    @include fixed-top();
    .domestic-nav_brand { margin-left: -43px; }
    .swoosh-logo { @include opacity(100); }
    .domestic-nav_brand-divider { display: inline-block; @include opacity(100); width: 25px; margin-left: 8px; }
    .domestic-nav_brand, .domestic-menus { @include translate(2 * $domesticNavLogoMargin + $swooshLogoWidth, 0); }
  }
}

.domestic-nav_brand {
  float:left;
  margin-left: -43px;

  padding-top: 0;
  height: 46px; 

  @include transition( $domesticNavBrandAnimationTime ease-in-out );

  .swoosh-logo {
    margin: 13px 12px;
    vertical-align: top;

    display: inline-block;
    @include opacity(0);

    @include transition( opacity $domesticNavBrandAnimationTime ease-in-out );
  }
}

.domestic-nav_title {
  position: static;
  vertical-align: top;
  margin-right: 75px;

  display: inline-block;
  padding-top: 14px;

  font-size: 18px;
  color: $domestic-navbar-text-color;
}

.domestic-nav_brand-divider {
  margin-top: 14px;
  margin-right: 0;
  margin-left: 0;

  display: inline-block;
  width: 1px;
  height: 22px;
  border-left: 1px solid #9b9b9b; 
  @include opacity(0);

  @include transition( all $domesticNavBrandAnimationTime ease-in-out ); 
}

.sui-opt-in { // .sui-opt-in for specificity over .sui-opt-in ul
.domestic-menus {
  margin-left: -5px;
  float: left;

  @include transition( $domesticNavBrandAnimationTime ease-in-out );

  .domestic-menus_entry.domestic-menus_dropmenu.open {
    .domestic-menus_submenu:before { @include menu-notch(8px, 8px, #e2e2e2); left:18px; } // notch "shadow"
    .domestic-menus_submenu:after { @include menu-notch(5px, 6px, white); left: 21px; }   // notch
  }
}
}

.secondary-menus {
  float: right;

  .domestic-menus_entry {
    & + .domestic-menus_entry {
      margin-left: 20px; padding-left: 20px;
      &:before {
        content: " "; border-left: 1px solid #e0e0e0; position: absolute;
        left: 0px; top: 12px; display: inline-block; height: 25px;
      }
    }

    &:last-child {
      margin-right: -5px;
    }
  }
}

.sui-opt-in { // .sui-opt-in for specificity over .sui-opt-in ul
.domestic-menus_submenu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1020;
  float: left;
  margin-top: -3px;
  margin-left: -17px;

  display: none;
  @include border-radius(3px);
  @include border-top-radius(0);
  overflow: visible;
  padding: 13px 15px;

  @include box-shadow(0 1px 5px rgba(0,0,0,0.2));
  background-color: white;

  .domestic-menus_submenu_items {
    margin-left:0;
  }

  label {
    color: #333333; font-size: 11px; font-weight: bold;
    text-transform: uppercase; white-space:nowrap; margin-bottom: 1px;
  }

  .domestic-menus_submenu_items + label { margin-top:12px; }
}
} // .sui-opt-in

.sui-opt-in { // .sui-opt-in for specificity over .sui-opt-in ul
.domestic-menus_submenu_items {
  a {
    clear: both;

    display: block;
    white-space: nowrap;
    min-width: 100px;            
    padding: 3px 7px; 

    font-weight: normal;
    line-height: 18px;
    color: #333333;
    font-size: 12px; 

    &:hover {
      border-radius: 3px;
      background-color: #F2F2F2;
    }
  }
}
}

.domestic-menus_entry {
  position: relative;

  display:inline-block;

  & + .domestic-menus_entry { margin-left: 30px; }

  > a {
    display: inline-block;
    padding: 16px 5px 13px;

    color: $domestic-navbar-text-color;

    &:hover { color: $domestic-navbar-text-color; }

    i { margin: 2px 3px 0 0; }
  }

  &.active > a { padding-bottom: 10px; border-bottom: 3px solid #9b9b9b; }

  &.domestic-menus_dropmenu {
    max-width: none;

    > a { padding-right: 15px; @include navmenu-chevron( 24px, 3px, 4px ); }
  }

  &.open .domestic-menus_submenu {
    display: block;
  }
}


/////////////////////////////////////////////////////////////////
// Search Ribbon
/////////////////////////////////////////////////////////////////

// Hacks for now b/c of ugly highlight from app excerpts
.search-ribbon .search-ribbon_result-excerpt .highlight { font-weight: normal; background-color: transparent; }

.search-ribbon {
  position: absolute;
  top: $global-navbar-height;
  z-index: $zindexNavBar;  

  width: 100%;
  display: none;

  &.affix {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;    

    .search-ribbon_controls {
      @include border-top-radius(0);
    }
  }

  &.shown { @include opacity(100); }
}

$searchInputWidth: 400px;
$resultSidePadding: 6px;

.search-ribbon_controls {
  margin: 0;
  position: absolute; // within nav-fluid-container within full width .search-ribbon 

  width: 524px;
  padding: 11px;
  @include border-radius(3px);

  background-color: $domestic-navbar-bg-color;
  @include box-shadow($globalDropdownShadow);
  font-family: $styledFontFamily;

  form {
    display: inline-block;
    margin-left: -1px;
  }

  input {
    @include box-sizing(border-box);
    width: $searchInputWidth;
    height: 33px;
    margin-bottom: 0;

    @include border-left-radius(0);

    &:focus {
      @include box-shadow(inset 0 1px 3px rgba(0, 0, 0, 0.1)); // Copied from standard 'input' (sans :focus)
      border-color: #d4d4d4; // Copied from standard 'input' (sans :focus)
      outline: none;
    }

    &::-ms-clear {
      display: none;
    }
  }

  button {
    margin-left: 5px;

    @include box-sizing(border-box);
    height: 33px;
  }

}

.search-ribbon_spinner {
  position: absolute; // within search-ribbon_controls
  right: 89px;
  top: 21px;

  @include loading-circles( sui-gray, 0.9s, 0.2 );
}

.search-ribbon_app-selector {
  display: inline-block;

  .sui-dropdown-toggle {
    @include box-sizing(border-box);
    width: 56px;
    height: 33px;
    padding-top: 7px;    

    @include border-right-radius(0);

    .caret {
      border-top-color: #888888;
    }
  }

  .sui-dropdown-menu {
    margin-top: 2px;

    @include box-shadow(0px 0px 5px 1px rgba(0, 0, 0, 0.2));

    a {
      padding: 8px;

      @include border-radius(3px);

      &[data-selected=true] {
        background-color: white;
      }

      &:hover {
        background-color: #f3f3f3;
      }

      i {
        display: inline-block;
        vertical-align: top;
        margin-right: 8px;
      }
      span {
        vertical-align: top;
        display: inline-block;
        line-height: 16px;
      }
    }
  }
}

.search-ribbon_controls.search-ribbon_single-app {
  width: 468px;

  .search-ribbon_app-selector {
    display: none;
  }

  input {
    @include border-left-radius(3px);
  }

  .search-ribbon_results {
    margin-left: -234px;
  }
}

.search-ribbon_results {
  position: absolute;
  top: 47px;
  left: 50%;
  margin-left: -206px; // A little brittle, but carefully positioned to match the input


  display: none;
  box-sizing: border-box;
  width: $searchInputWidth - 2px; // Input has a border but results don't, so subtract
  @include border-radius(3px);
  padding: 4px;

  background-color: white;
  @include box-shadow(0px 0px 5px 1px rgba(0, 0, 0, 0.2));
}

.search-ribbon_groups {
  margin-top: 4px;

  border-top: 1px solid #ebebeb;
  padding-top: 10px;
  overflow: hidden;
}

.search-ribbon_group {
  & + .search-ribbon_group {
    margin-top: 10px; 
  }
}

.search-ribbon_group-name {
  display: block;

  padding-left: $resultSidePadding;

  font-size: 12px;
  font-weight: bold;
  color: #999;
  text-transform: uppercase;
}

.sui-opt-in {  // .sui-opt-in ul is styled with a margin. grrr.
.search-ribbon_group-results {
  margin: 0; 
}
}

.search-ribbon_result {
  display: block;

  padding: $resultSidePadding;

  &.is-selected {
    @include border-radius(3px);
    background-color: #f3f3f3;
  }

  > a {
    display: block;
    color: $textColor;

    &:hover {
      color: $textColor;
      text-decoration: none;
    }
  }

  .navbar-icon {
    display: inline-block;
    margin-right: $resultSidePadding;
    vertical-align: top;
  }
}

.search-ribbon_result-name {
  display: inline-block;
  vertical-align: top;


  width: 90%;
  overflow: hidden;
  line-height: 16px;

  white-space: nowrap;
  text-overflow: ellipsis;
}

.search-ribbon_result-excerpt {
  display: block;
  margin-left: 16px + $resultSidePadding + 1px;

  line-height: 1.2;

  font-size: 11px;
  color: #999;
}


/////////////////////////////////////////////////////////////////
// Mobile Nav (disabled)
/////////////////////////////////////////////////////////////////

.mobile-nav { display:none; }

// Magnifying glass in search...
// westons (2015-05-13): Moved here from sui-responsive-include.scss
// b/c it includes a sui-image which doesn't work properly there
.mobile-nav,
.sui-opt-in .mobile-nav {
  .nav-search-content:after {
    content: " ";
    position: absolute;
    right:8px;
    top:8px;

    display: block;
    width: 14px;
    height: 14px;

    background-image: sui-image('sprites/icon_14px_sprites.png');
    background-position: -96px  -24px;
    background-repeat: no-repeat;
  }
}

/////////////////////////////////////////////////////////////////
// IE Fixes
/////////////////////////////////////////////////////////////////
.ie8 .domestic-nav .domestic-brand .swoosh-logo {
  background-image: sui-image('masthead/orange-swoosh-forie.png');
  background-size: auto;
}
